public class Tool {
    private String code;
    private String type;
    private String brand;
    private double dailyCharge;
    private boolean chargeOnWeekends;
    private boolean chargeOnHolidays;

    public Tool(String code, String type, String brand, double dailyCharge, boolean chargeOnWeekends, boolean chargeOnHolidays) {
        this.code = code;
        this.type = type;
        this.brand = brand;
        this.dailyCharge = dailyCharge;
        this.chargeOnWeekends = chargeOnWeekends;
        this.chargeOnHolidays = chargeOnHolidays;
    }

    public String getCode() { return code; }
    public String getType() { return type; }
    public String getBrand() { return brand; }
    public double getDailyCharge() { return dailyCharge; }
    public boolean isChargeOnWeekends() { return chargeOnWeekends; }
    public boolean isChargeOnHolidays() { return chargeOnHolidays; }
}
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.time.temporal.ChronoUnit;
import java.util.HashMap;
import java.util.Map;

public class RentalAgreement {
    private Tool tool;
    private int rentalDays;
    private LocalDate checkoutDate;
    private LocalDate dueDate;
    private double discountPercent;
    private int chargeDays;
    private double preDiscountCharge;
    private double discountAmount;
    private double finalCharge;

    public RentalAgreement(Tool tool, int rentalDays, LocalDate checkoutDate, double discountPercent) {
        this.tool = tool;
        this.rentalDays = rentalDays;
        this.checkoutDate = checkoutDate;
        this.dueDate = checkoutDate.plusDays(rentalDays);
        this.discountPercent = discountPercent;
        calculateCharges();
    }

    private void calculateCharges() {
        chargeDays = calculateChargeDays(checkoutDate, dueDate);
        preDiscountCharge = chargeDays * tool.getDailyCharge();
        discountAmount = preDiscountCharge * (discountPercent / 100);
        finalCharge = preDiscountCharge - discountAmount;
    }

    private int calculateChargeDays(LocalDate start, LocalDate end) {
        int chargeableDays = 0;
        for (LocalDate date = start.plusDays(1); !date.isAfter(end); date = date.plusDays(1)) {
            if (isChargeableDay(date)) {
                chargeableDays++;
            }
        }
        return chargeableDays;
    }

    private boolean isChargeableDay(LocalDate date) {
        if (!tool.isChargeOnWeekends() && (date.getDayOfWeek().getValue() == 6 || date.getDayOfWeek().getValue() == 7)) {
            return false;
        }
        if (!tool.isChargeOnHolidays() && isHoliday(date)) {
            return false;
        }
        return true;
    }

    private boolean isHoliday(LocalDate date) {
        int year = date.getYear();
        LocalDate independenceDay = LocalDate.of(year, 7, 4);
        if (independenceDay.getDayOfWeek().getValue() == 6) {
            independenceDay = independenceDay.minusDays(1);
        } else if (independenceDay.getDayOfWeek().getValue() == 7) {
            independenceDay = independenceDay.plusDays(1);
        }
        LocalDate laborDay = LocalDate.of(year, 9, 1).with(TemporalAdjusters.firstInMonth(DayOfWeek.MONDAY));
        return date.equals(independenceDay) || date.equals(laborDay);
    }

    public void print() {
        DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern("MM/dd/yy");
        System.out.println("Tool code: " + tool.getCode());
        System.out.println("Tool type: " + tool.getType());
        System.out.println("Tool brand: " + tool.getBrand());
        System.out.println("Rental days: " + rentalDays);
        System.out.println("Check out date: " + checkoutDate.format(dateFormatter));
        System.out.println("Due date: " + dueDate.format(dateFormatter));
        System.out.println("Daily rental charge: $" + String.format("%.2f", tool.getDailyCharge()));
        System.out.println("Charge days: " + chargeDays);
        System.out.println("Pre-discount charge: $" + String.format("%.2f", preDiscountCharge));
        System.out.println("Discount percent: " + String.format("%.0f", discountPercent) + "%");
        System.out.println("Discount amount: $" + String.format("%.2f", discountAmount));
        System.out.println("Final charge: $" + String.format("%.2f", finalCharge));
    }
}
import java.time.LocalDate;
import java.util.HashMap;
import java.util.Map;

public class Checkout {
    private static Map<String, Tool> tools = new HashMap<>();

    static {
        tools.put("CHNS", new Tool("CHNS", "Chainsaw", "Stihl", 1.49, false, true));
        tools.put("LADW", new Tool("LADW", "Ladder", "Werner", 1.99, true, false));
        tools.put("JAKD", new Tool("JAKD", "Jackhammer", "DeWalt", 2.99, false, false));
        tools.put("JAKR", new Tool("JAKR", "Jackhammer", "Ridgid", 2.99, false, false));
    }

    public static RentalAgreement checkout(String toolCode, int rentalDays, double discountPercent, LocalDate checkoutDate) throws IllegalArgumentException {
        if (rentalDays < 1) {
            throw new IllegalArgumentException("Rental day count must be 1 or greater.");
        }
        if (discountPercent < 0 || discountPercent > 100) {
            throw new IllegalArgumentException("Discount percent must be between 0 and 100.");
        }
        Tool tool = tools.get(toolCode);
        if (tool == null) {
            throw new IllegalArgumentException("Invalid tool code.");
        }
        return new RentalAgreement(tool, rentalDays, checkoutDate, discountPercent);
    }
}
import org.junit.jupiter.api.Test;
import java.time.LocalDate;
import static org.junit.jupiter.api.Assertions.*;

class CheckoutTest {
    @Test
    void test1() {
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () -> {
            Checkout.checkout("JAKR", 5, 101, LocalDate.of(2015, 9, 3));
        });
        assertEquals("Discount percent must be between 0 and 100.", exception.getMessage());
    }

    @Test
    void test2() {
        RentalAgreement agreement = Checkout.checkout("LADW", 3, 10, LocalDate.of(2020, 7, 2));
        agreement.print();
    }

    @Test
    void test3() {
        RentalAgreement agreement = Checkout.checkout("CHNS", 5, 25, LocalDate.of(2015, 7, 2));
        agreement.print();
    }

    @Test
    void test4() {
        RentalAgreement agreement = Checkout.checkout("JAKD", 6, 0, LocalDate.of(2015, 9, 3));
        agreement.print();
    }

    @Test
    void test5() {
        RentalAgreement agreement = Checkout.checkout("JAKR", 9, 0, LocalDate.of(2015, 7, 2));
        agreement.print();
    }

    @Test
    void test6() {
        RentalAgreement agreement = Checkout.checkout("JAKR", 4, 50, LocalDate.of(2020, 7, 2));
        agreement.print();
    }
}
